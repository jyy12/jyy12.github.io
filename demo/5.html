(function(win){
    var wifi;
    var ua = win.navigator.userAgent;
    var con = win.navigator.connection;
    // 如果是微信
    if(/MicroMessenger/.test(ua)){
        
        // 如果是微信6.0以上版本，用UA来判断
        if(/NetType/.test(ua)){
        
            var result = ua.match(/NetType\/(\S)+/)[0].replace('NetType/','');
            
            if(result && result != 'WIFI'){
                wifi = false;
            }else if(result && result=="WIFI"){
                wifi=true
            }
        // 如果是微信6.0以下版本，调用微信私有接口WeixinJSBridge
        }else{
            document.addEventListener("WeixinJSBridgeReady",function onBridgeReady(){
                WeixinJSBridge.invoke('getNetworkType',{},function(e){
                    if(e.err_msg != "network_type:wifi"){
                        wifi = false;
                    }else{
                        wifi = true;
                    }
                });
            });
        }
    // 如果支持navigator.connection
    }else if(con){
    
        var network = con.type;
        if(network == "wifi" || network == "2" || network == "unknown"){  // unknown是为了兼容Chrome Canary
            wifi = true;
        }else{
            wifi = false
        }
    }
    win.networkWIFI = wifi;
    alert(networkWIFI)
})(window);
